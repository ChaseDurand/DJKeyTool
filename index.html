<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DJ Key Tool</title>
    <link rel="icon" type="image/png" href="favicon.png" />
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Hide content initially to prevent flash */
        body { opacity: 0; transition: opacity 0.2s; }
        body.loaded { opacity: 1; }
    </style>
    <script>
        // Load settings immediately to set initial states
        (function() {
            const saved = localStorage.getItem('djKeyToolSettings');
            if (saved) {
                try {
                    const settings = JSON.parse(saved);
                    // Store settings globally for immediate use
                    window.initialSettings = settings;
                } catch (e) {
                    window.initialSettings = { majorOnTop: false, volume: 0.7, notationType: 'camelot', useFlats: false };
                }
            } else {
                window.initialSettings = { majorOnTop: false, volume: 0.7, notationType: 'camelot', useFlats: false };
            }
            
            // Set checkbox states immediately when DOM is ready
            document.addEventListener('DOMContentLoaded', function() {
                const settings = window.initialSettings;
                document.getElementById('major-on-top').checked = settings.majorOnTop;
                document.getElementById('notation-toggle').checked = settings.notationType === 'openkey';
                document.getElementById('flats-toggle').checked = settings.useFlats;
                document.getElementById('volume-slider').value = settings.volume;
            }, { once: true });
        })();
    </script>
</head>
<body>
    <div class="main-container">
        <div class="wheel-container">
            <svg class="note-wheel" viewBox="0 0 800 800">
                <g id="wheel"></g>
            </svg>
            <div class="center-circle">
                <div class="center-display" id="center-display">
                    <div class="center-main-key" id="center-main-key">--</div>
                    <div class="center-alt-key" id="center-alt-key">--</div>
                </div>
            </div>
        </div>
        
        <div class="right-panel">
            <div class="options-panel">
            <div class="options-title">Options</div>
            <div class="toggle-container">
                <label>
                    <input type="checkbox" class="option-checkbox" id="major-on-top" tabindex="-1">
                    <div class="toggle-switch">
                        <span class="toggle-option left">Minor</span>
                        <span class="toggle-option right">Major</span>
                    </div>
                </label>
            </div>
            <div class="toggle-container">
                <label>
                    <input type="checkbox" class="option-checkbox" id="notation-toggle" tabindex="-1">
                    <div class="toggle-switch">
                        <span class="toggle-option left">Camelot</span>
                        <span class="toggle-option right">Open Key</span>
                    </div>
                </label>
            </div>
            <div class="toggle-container">
                <label>
                    <input type="checkbox" class="option-checkbox" id="flats-toggle" tabindex="-1">
                    <div class="toggle-switch">
                        <span class="toggle-option left">Sharps (#)</span>
                        <span class="toggle-option right">Flats (b)</span>
                    </div>
                </label>
            </div>
            <div class="option-group">
                <div class="volume-label">Volume</div>
                <input type="range" class="volume-slider" id="volume-slider" min="0" max="1" step="0.01" tabindex="-1">
            </div>
        </div>
        
        <div class="piano-container">
            <div class="piano-keyboard" id="piano-keyboard"></div>
        </div>

        <div class="octave-controls">
            <button class="octave-button" id="octave-down">
                Octave -
                <span class="octave-key-hint">Z</span>
            </button>
            <span class="octave-display" id="octave-display">Octave: 0</span>
            <button class="octave-button" id="octave-up">
                Octave +
                <span class="octave-key-hint">X</span>
            </button>
        </div>

    </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>